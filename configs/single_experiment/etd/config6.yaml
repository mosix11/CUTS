global_seed: 11
# Paper setting https://arxiv.org/pdf/2307.09542 for ETD
training_seed: &training_seed 11
dataset_seed: &dataset_seed 11


strategy:
  # finetuning_set: &finetuning_set 'LowLoss'
  # percentage: 0.4
  noise:
    set: 'Train'
    noise_rate: 0.1
    noise_type: 'symmetric'
    seed: 8

dataset:
  name: "cifar10"
  num_classes: &num_classes 10
  img_size: [32, 32]
  batch_size: 512
  subsample_size: [-1, -1]
  class_subset: []
  remap_labels: False
  heldout_conf: null
  grayscale: False
  normalize_imgs: True
  flatten: False
  valset_ratio: 0.0
  num_workers: 8
  seed: *dataset_seed


model:
  standard:
    type: 'resnet9v1_etd'
    init_channels: 64
    img_size: [32, 32]
    num_classes: *num_classes
    dropout:
      p_fixed: 0.4
      p_mem: 0.2
      num_training_samples: 50000
      eval_mode: 'standard'
    loss_fn: 'CE'
    metrics: ['ACC', 'F1']
  drop:
    type: 'resnet9v1_etd'
    init_channels: 64
    img_size: [32, 32]
    num_classes: *num_classes
    dropout:
      p_fixed: 0.4
      p_mem: 0.2
      num_training_samples: 50000
      eval_mode: 'drop'
    loss_fn: 'CE'
    metrics: ['ACC', 'F1']

trainer:
  max_epochs: &max_epochs 50
  optimizer_cfg: 
    type: "sgd"
    lr: 1.0e-2
    momentum: 0.9
    weight_decay: 5.0e-4
  lr_schedule_cfg:
    type: 'onecycle'
    max_lr: 0.1
    pct_start: 0.2
    
  early_stopping: False
  validation_freq: -1
  save_best_model: False
  checkpoint_freq: -1
  run_on_gpu: True
  use_amp: True
  log_comet: True
  comet_project_name: 'example-tied-dropout'
  seed: *training_seed

